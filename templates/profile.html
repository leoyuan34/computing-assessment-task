{% extends "base.html" %}
{% block title %}Profile - Transit Travel Forum{% endblock %}
{% block content %}

<h1>My Profile</h1>

<div class="profile-container">
  <div class="profile-header">
    <img src="{{ url_for('static', filename='images/profile.png') }}" alt="Profile Picture" class="profile-pic-large">
    <div class="profile-info">
      <h2>{{ session.get('user', 'Guest') }}</h2>
      <p class="profile-email">{{ user_email }}</p>
    </div>
  </div>

  {% if success %}
  <div class="message success-message">
    <i class="fa-solid fa-circle-check"></i> {{ success }}
  </div>
  {% endif %}

  {% if error %}
  <div class="message error-message">
    <i class="fa-solid fa-circle-exclamation"></i> {{ error }}
  </div>
  {% endif %}

  <div class="profile-section">
    <h3><i class="fa-solid fa-user-pen"></i> Edit Profile</h3>
    
    <form method="POST" action="{{ url_for('update_username') }}" class="profile-form">
      <div class="form-group">
        <label for="new_username">Username</label>
        <input type="text" id="new_username" name="new_username" value="{{ session.get('user', '') }}" required>
      </div>
      <button type="submit" class="btn-primary">Update Username</button>
    </form>

    <form method="POST" action="{{ url_for('update_email') }}" class="profile-form">
      <div class="form-group">
        <label for="new_email">Email</label>
        <input type="email" id="new_email" name="new_email" value="{{ user_email }}" required>
      </div>
      <button type="submit" class="btn-primary">Update Email</button>
    </form>

    <form method="POST" action="{{ url_for('update_password') }}" class="profile-form">
      <div class="form-group">
        <label for="current_password">Current Password</label>
        <input type="password" id="current_password" name="current_password" required>
      </div>
      <div class="form-group">
        <label for="new_password">New Password</label>
        <input type="password" id="new_password" name="new_password" required>
      </div>
      <div class="form-group">
        <label for="confirm_password">Confirm New Password</label>
        <input type="password" id="confirm_password" name="confirm_password" required>
      </div>
      <button type="submit" class="btn-primary">Change Password</button>
    </form>
  </div>

  <div class="profile-section">
    <h3><i class="fa-solid fa-gear"></i> Account Settings</h3>
    <a href="{{ url_for('logout') }}" class="btn-secondary">
      <i class="fa-solid fa-right-from-bracket"></i> Logout
    </a>
  </div>
</div>

{% endblock %}